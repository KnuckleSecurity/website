[
  
    {
      "title"    : "Tryhackme Blue Ctf Writeup",
      "category" : "",
      "tags"     : "ctf, pentesting, metasploit, remote-code-execution, buffer-overflow, and cracking",
      "url"      : "/2021/10/09/tryhackme-blue-ctf-writeup/",
      "date"     : "Oct 9, 2021",
      "content"  : "Solve Yourself »Blue is a machine that specifically designed to cover EternalBlue (CVE-2017-0144), which allows remote attackers to execute arbitrary code via crafted packets, aka “Windows SMB Remote Code Execution Vulnerability.” 1-EnumerationLet us run Network Mapper (nmap) to discover opened ports and services.            Parameter      Functionality                  -sV      Probe open ports to determine service/version info              -sC or –script=default      Performs a script scan using the default set of scripts              -O      Enable OS detection              -T4      T{0-5} Set scan speed, higher is faster              -p-      Scan all 65536 ports      Full command :nmap &lt;machine IP&gt; -sV -sC -O -T4 -p- It seems like plenty of services are enabled in the system.However one of them catches the eye.445 /tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup : WORKGROUP)After went through the web searching phase for that specific service, we got this:CVE-2017-0144 - EternalBlue SMB Remote Code Execution (MS17-010)2-ExploitationLet’s use Metasploit frameworkAnd than use MS17-010Six modules are showed up, two of them are auxiliary modules and the rest are exploiting scripts.In a real-life scenario it is not that obvious that those pre-arranged scripts would work.It is highly possible that target system would crash if you ran any careless exploit to target system or you are not sure host is vulnerable to it. To check this we can run auxiliary module.If you are not familiar with what an auxiliary module is, it is some kind of script that helps us to verify if the target system is vulnerable to our actual exploit or not, without crashing or corrupting the system.More technical description would be as following; An auxiliary module does not execute a payload. It can be used to perform arbitrary actions that may not be directly related to exploitation. Examples of auxiliary modules include scanners, fuzzers, and denial of service attacks.In this case Metasploit database offers us those two auxiliary files, run:use auxiliary/scanner/smb/smb_ms17_010Than set RHOSTS  as IP address of  our target machine, and run it.As you can see, the output tells us the that, Host is likely VULNERABLE to MS17-010 !!! After that point we got our proof that the exploit would work.So let us move to the exploitation phase.Exploit - An exploit module executes a sequence of commands to target a specific vulnerability found in a system or application. An exploit module takes advantage of a vulnerability to provide access to the target system. Exploit modules include buffer overflow, code injection, and web application exploit.Run:use exploit/windows/smb/ms17_010_eternalblueLike the previous auxiliary module, set RHOSTS as our target machine and run it.Congrats !!! You’ve hacked into the machine by using MS17-010 vulnerability.Now we have got our Meterpreter shell which provides additional powerful tools.Now we need to use getsystem command,which is provided by Metasploit’s meterpreter shell, that will use number of different techniques in attempt to gain SYSTEM level priveleges on the remote target. Now, lets list all runnig processes with ps command, we will need to migrate our suspicious process into trusted process to ensure consistency.SearchIndexer.exe seems like a good candidate to migrate our process.So type migrate {PID} to migrate spoolsv.exe, which is our reverse tcp payload.Right now we have %100 access to target system and our session’s persistance is solid, lets move on for crediantels and flags.3-Post Exploitation - Capturing the FlagsJust like the getsystem command, meterpreter provides hashdump command, which brings the system hashes for us.We need to find out what kind of hashes they are. It is easy to tell they are NTLM hashes, because Windows is using NTLM hashes for system as default but for the best practice, lets use a hash analyzer to identify the type, you can use any hash analyzer.As you can see, it is NTLM.So, as we know the hash type, we can move forward for to cracking it.I will use John the Ripper,you can use Hashcat or any other cypher cracking tool.            Parameter      Functionality                  hashes      ASCII Text file, which contains copied hashes.              –wordlist      Location of the wordlist              -format      Hash format      We’ve cracked the first hash.Now type shell to use windows’ shell instead of meterpreter shell and start looking for flags.flag1.txtflag2.txtflag3.txtCongrats! End of the machine.",
      "article"  : "<div class='article col col-4 col-d-6 col-t-12 grid__post animate'> <div class='article__inner'><a class='article__image' href='/2021/10/09/tryhackme-blue-ctf-writeup/'> <img src='/assets/img/posts/tryhackme-blue-ctf-writeup/blue1.jpg' alt='Tryhackme Blue Ctf Writeup'> </a><div class='article__content'> <div class='article__meta'> <span class='article__minutes'>5 min read <time class='article__date' datetime='2021-10-09T00:59:00+01:00'>Oct 9, 2021</time> </span> </div><h2 class='article__title'>Tryhackme Blue Ctf Writeup</h2> <p class='article__excerpt'></p><div class='article__bottom'><div class='article__author'> <a href='/about/' aria-label='Burak Baris'><img class='article__author-image' src='/images/15.jpg' alt='Burak Baris's Picture'></a> </div><div class='article__bottom-meta'><a href='/about/' class='article__author-link'>Burak Baris</a><span> in </span> <span class='article-tags'> <a href='/tag/ctf' class='article__tag'>ctf</a>  <a href='/tag/pentesting' class='article__tag'>pentesting</a>  <a href='/tag/metasploit' class='article__tag'>metasploit</a>  <a href='/tag/remote-code-execution' class='article__tag'>remote-code-execution</a>  <a href='/tag/buffer-overflow' class='article__tag'>buffer-overflow</a>  <a href='/tag/cracking' class='article__tag'>cracking</a> </span></div></div></div></div></div>"
    } 
  
]
