I"' <h1 id="enumeration">ENUMERATION</h1>

<p>Run Network Mapper (<strong>nmap</strong>) on Hackpark machine to discover opened ports and services.</p>

<p>Full command :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">nmap <span class="nt">-sV</span> <span class="nt">-sS</span> <span class="nt">-O</span> <span class="nt">-T4</span> <span class="nt">-p-</span> <span class="o">{</span>machine IP<span class="o">}</span> <span class="nt">-Pn</span> <span class="nt">-oN</span> <span class="o">{</span>outputfile<span class="o">}</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Parameter</th>
      <th style="text-align: left">Functionality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-sV</td>
      <td style="text-align: left">Probe open ports to determine service/version info</td>
    </tr>
    <tr>
      <td style="text-align: left">-sS</td>
      <td style="text-align: left">SYN, half TCP scan</td>
    </tr>
    <tr>
      <td style="text-align: left">-O</td>
      <td style="text-align: left">Enable OS detection</td>
    </tr>
    <tr>
      <td style="text-align: left">-T4</td>
      <td style="text-align: left">T{0-5} Set scan speed, higher is faster</td>
    </tr>
    <tr>
      <td style="text-align: left">-p-</td>
      <td style="text-align: left">Scan all 65536 ports</td>
    </tr>
    <tr>
      <td style="text-align: left">-Pn</td>
      <td style="text-align: left">Skip host discovery</td>
    </tr>
    <tr>
      <td style="text-align: left">-oN</td>
      <td style="text-align: left">Write output to a file</td>
    </tr>
  </tbody>
</table>

<p>Output of the scan:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Nmap 7.92 scan initiated Thu Dec 30 14:40:55 2021 as: nmap -sV -sS -O -T4 -p- -Pn -oN hackpark.nmap 10.10.123.142</span>
Nmap scan report <span class="k">for </span>10.10.123.142
Host is up <span class="o">(</span>0.033s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
PORT     STATE SERVICE            VERSION
80/tcp   open  http               Microsoft IIS httpd 8.5
3389/tcp open  ssl/ms-wbt-server?
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device <span class="nb">type</span>: general purpose
Running <span class="o">(</span>JUST GUESSING<span class="o">)</span>: Microsoft Windows 2012 <span class="o">(</span>89%<span class="o">)</span>
OS CPE: cpe:/o:microsoft:windows_server_2012
Aggressive OS guesses: Microsoft Windows Server 2012 <span class="o">(</span>89%<span class="o">)</span>, Microsoft Windows Server 2012 or Windows Server 2012 R2 <span class="o">(</span>89%<span class="o">)</span>, Microsoft Windows Server 2012 R2 <span class="o">(</span>89%<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span><span class="nb">test </span>conditions non-ideal<span class="o">)</span><span class="nb">.</span>
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Thu Dec 30 14:43:54 2021 -- 1 IP address (1 host up) scanned in 179.18 seconds</span></code></pre></figure>

<p>Two ports opened:</p>

<h2 id="port-3389-sslms-wbt-server">Port 3389 ssl/ms-wbt-server?</h2>
<p>Port 3389 is running an <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/understanding-remote-desktop-protocol">RDP</a> service.
However, it is not possible to exploit it since we do not have any information about the version of the service.</p>

<h2 id="port-80-http-microsoft-iis-httpd-85">Port 80 http Microsoft IIS httpd 8.5</h2>
<p><a href="https://en.wikipedia.org/wiki/Internet_Information_Services"><strong>Microsoft IIS</strong></a> web server is running on port 80.
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/1.png" alt="" />
<br /><br />Let us quickly check the <a href="https://www.cloudflare.com/learning/bots/what-is-robots.txt/">robots.txt</a> to see if we can find something interesting.
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/3.png" alt="" />
Nothing fancy here. Let us move on.
<br /><br /><a href="https://github.com/maurosoria/dirsearch">Dirsearch</a> can help us to enumerate subdirectories of the webserver.
Frameworks like <strong>GoBuster</strong> and <strong>DirBuster</strong> are also an option.
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/2.png" alt="" />
The <strong>/admin</strong> directory might be interesting. However, the request to the directory gets redirected to a <strong>.aspx</strong> file 
which is probably a login form.
<br /><br /><img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/4.png" alt="" />
We will have to launch a <a href="https://www.fortinet.com/resources/cyberglossary/brute-force-attack">brute-force</a> attack in order to
gain access to the backend panel.
<br /><br />There is only one blog post published on the main page, and the author of it is the <strong>ADMINISTRATOR</strong>. 
So we can assume that the only user registered to the panel is the adminâ€™s itself.
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/5.png" alt="" /></p>

<h1 id="exploitaton">EXPLOITATON</h1>

<h2 id="brute-forcing-the-panel">Brute-Forcing the Panel</h2>
<p>In order to create continuous HTTP requests, we have to know how the HTTP request looks.
Launch the <a href="https://www.geeksforgeeks.org/what-is-burp-suite/"><strong>Burp Suite</strong></a> to examine the HTTP POST request sent 
when a login attempt occurs.
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/5.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/6.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/7.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/8.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/9.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/10.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/11.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/12.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/13.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/14.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/15.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/16.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/17.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/18.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/19.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/20.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/21.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/22.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/23.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/24.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/25.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/26.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/27.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/28.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/29.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/30.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/31.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/32.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/33.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/34.png" alt="" />
<img src="/assets/img/posts/tryhackme-hackpark-ctf-writeup/35.png" alt="" /></p>
:ET