I"W*<p>This post will discuss all the terminologies behind <strong><em>Public Key Infrastructure (PKI)</em></strong>.
It is essential to have the knowledge on <em>Public Key Cryptography</em> ,<em>Encryption</em> and <em>Digital Signing</em> as the prequisition.</p>

<h1 id="what-is-pki">WHAT IS PKI?</h1>
<p><strong><em>Public Key Infrastructure (PKI)</em></strong> is a system on which every connection that requires to establish and manage <em>Public Key
Encryption</em> depends. This procedure done by what we call <strong><em>X.509 certificates</em></strong>.</p>
<h1 id="why-pki-is-important">WHY PKI IS IMPORTANT?</h1>
<p>While public-key encryption solves the problem of the data’s legibility by everyone, PKI adds authentication mechanism on top of it.
Combination of those two mechanism together makes online communication becomes much more trustworthy.</p>
<h1 id="real-life-scenario">REAL LIFE SCENARIO</h1>

<p>Let us examine this example:</p>

<ul>
  <li><strong>John</strong>: Hey Robert, can you send those confidential data to Ashley?</li>
  <li><strong>Robert</strong>: Sure, but who is she?</li>
  <li><strong>John</strong>: She is the HR manager of BBSec.</li>
  <li><strong>Robert</strong>: All right.</li>
</ul>

<p><br />For Robert to send any confidential data to Ashley, he must find Ashley’s public-key. However, searching for her
public-key on the web would not be smart since there could be many other public-keys for other Ashleys. How can Robert
be confident that he uses the correct public-key from the Ashley he wants to communicate?
<br /><br />To solve this problem, what we call <strong><em>x509 certificates</em></strong> comes into play.</p>

<h1 id="what-is-an-x509-certificate">WHAT IS AN X.509 CERTIFICATE?</h1>

<p><em>X.509</em> is a standard procedure for public-key certificates. They are digital documents that validate the integrity of the 
association between identities such as organizations, individuals or websites, and their cryptographic key pairs.
<br /><br />An <em>X.509 certificate</em> essentially contains those:</p>
<ul>
  <li>Identity’s name, address, email,etc.</li>
  <li>Identity’s public-key.</li>
  <li>The <em>Issuer</em> of the certificate.</li>
  <li>The <em>encrypted hash</em> of the certificate.</li>
</ul>

<p>If Robert can find a certificate that binds Ashley’s name with her company BBSec, he can confidently tell that it is the correct
certificate he was looking for.
<br /><br />There are two more fields above, which are <em>Issuer</em> and <em>encrypted hash</em>. We will come to that later.</p>

<p>Common applications that use X.509 certificates:</p>
<ul>
  <li>TLS/SSL and HTTPS for encrypted and authenticated web browsing</li>
  <li>S/MIME Protocol for encrypted and signed email.</li>
  <li>Document signing</li>
  <li>Client authentication</li>
  <li>Goverment-issued electronic ID</li>
</ul>

<h1 id="certificate-authorities">CERTIFICATE AUTHORITIES</h1>

<p>However, what if Robert finds more than one certificate claiming to have Ashley’s public key? Now which one is the right one?
I can easily create a certificate identical to Ashley’s and put my public-key in it.
We need a mechanism to verify that the certificate assigned to a specific identity is one of its kind.
<br /><br />We have what we call <strong><em>Certificate Authorities (CAs)</em></strong> to solve this problem.  There are dozens of organizations that we 
trust to be authoritative. All operating systems and browsers come with built-in configured CAs. If a CA claims
a certificate is authentic, we will believe it. 
<br /><br />However, how does a CA indicate that the certificate in question is authentic?
By <em>signing</em> it digitally. The signature of the CA must be checked to verify the authenticity of a certificate.
<br /><br /> In the definition of an X.509 certificate above, there were two more fields left unexplained. <em>Issuer</em> and <em>Encrypted Hash</em>.</p>
<ul>
  <li>Issuer: The name of the organization (CA) that issued the certificate.</li>
  <li>Encrypted Hash: the digital signature of the CA.</li>
</ul>

<p>Let us continue to the Robert and Ashley example above:</p>

<ol>
  <li>Robert obtains certificate A that claims to be Ashley’s certificate and issued by X.</li>
  <li>To verify that certificate A is authentic by verifying CA’s signature, Robert gets the public key of X from somewhere, then
decrypts the <em>encrypted hash</em>, the digital signature, inside of certificate A to see if it matches.</li>
</ol>

<p>The question is that Robert just downloaded X’s certificate from somewhere, so how can he tell that it is also authentic? By looking
at the <em>Issuer</em> of X, which is Y. Now, he must find the Y certificate to verify the signature on the X certificate. We can continue
to do that endlessly. It becomes an endless loop, and we have to stop at one point.
<br /><br />To solve this problem we have what we call the <strong><em>Root CAs</em></strong>.</p>

<h1 id="what-is-a-root-ca">WHAT IS A ROOT CA?</h1>

<p>A <strong><em>top-level, root CA</em></strong> is a certificate authority that sits on the top of the authority hierarchy. CAs can sign their own certificates. These
are what we call <em>self-signed certificates</em>. Since it is not possible to validate self-signed certificates with PKI, Root CAs 
distribute their keys <em>out-of-band</em> (e.g. out-of-band distribution means non-electronic distributing, such as going to their offices
and getting their public key in person).
<br /><br />However, it would be harsh to go to the Root CAs office and collect their public key each time you intend to send an 
email to somebody. Web browsers come with more than 30 Root CAs. The browsers’ distributors are deciding who are truthful. By
using their browser, you trust their choice.
<br /><br />Let us get back to the Ashley and Robert example. If we assume that the certificate Y is a <em>self-signed</em> certificate and the organization Y
is indeed a <em>Root CA</em>, Robert can trust certificate A since X trusts A and Y trusts X.</p>

<h1 id="terminologies">TERMINOLOGIES</h1>

<h2 id="x509">X.509</h2>
<p>The protocol’s itself.</p>
<h2 id="pkix">PKIX</h2>
<p>Stands for <strong>P</strong>ublic  <strong>K</strong>ey <strong>I</strong>nfrastructure <strong>X</strong>.509</p>
<h2 id="abstract-syntax-notation-one-asn1">Abstract Syntax Notation One (<a href="https://en.wikipedia.org/wiki/ASN.1">ASN.1</a>)</h2>
<p>It is the syntax used to describe things in an X.509 certificate. For instancee, if the certificates were written in JSON, 
ASN.1 would be the syntax for the schema (This example is over-simplified).
Using ASN.1, it is possible to define data structures that 
can be transmitted over the network independently of software or hardware.</p>
<h3 id="der-pem-xer-per-ber-cer">DER, PEM, XER, PER, BER, CER</h3>
<p>Those are some of the popular encoding rules for ASN.1. 
<br /><em>DER</em> and <em>PEM</em> are the used.</p>
<h2 id="algorithm">Algorithm</h2>
<p>When the context is the PKI, it refers to cryptographic algorithms like “SHA1 with DSA”, “SHA1 with RSA”, etc. In order to
achieve cryptographic signing, first, we need to hash the data, then encrypt the hash. “SHA1 with RSA” would indicate that the
data hashed with SHA1 and encrypted with RSA.</p>
<h2 id="object-identifiers-oids">(<a href="https://en.wikipedia.org/wiki/Object_identifier">Object Identifiers OIDs</a>)</h2>
<p>Instead of using English to describe things in a X.509 certificate, <em>OIDs</em> are being used.
For instance, in a certificate 
instead of referring to the encryption field as “RSA”, which would be a string value, you would see its’ integer OID value “1.2.840.11359”.
<br /><a href="https://www.alvestrand.no/objectid/top.html">You can find the list of the registered OIDs here.</a></p>
<h2 id="privacy-enhanced-mail-pem">Privacy Enhanced Mail (<a href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">PEM</a>)</h2>
<p>If you hear PEM, it usually refers to DER. PEM is further encoded version of DER to base64.
Using PEM encoding can assist transmission over media that is sensitive to textual encodings.</p>
<h2 id="distinguished-name-dn">Distinguished Name (<a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ldap/distinguished-names?redirectedfrom=MSDN">DN</a>)</h2>
<p>Just referring someone with his/her name would not be helpful to identify someone. 
<em>DN</em> is used to identify someone uniquely by dividing attributes into fields like <strong>CN=Burak, DC=bbsec, DC=COM</strong>.</p>
<h2 id="simple-pki-spki">Simple PKI (<a href="https://crypto.stackexchange.com/questions/790/need-an-introduction-to-spki-or-spki-for-dummies">SPKI</a>)</h2>
<p>The PKI we were discussing (<a href="https://www.ietf.org/rfc/rfc5280.txt">RFC 5280</a>) binds a certificate with <em>distinguished name</em>.
SPKI (<a href="https://datatracker.ietf.org/doc/html/rfc2692">RFC 2692</a>) binds public key to a set of permissions. Not commonly used.</p>

<h2 id="public-key-cryptography-standrat-pkcs">Public Key Cryptography Standrat (<a href="https://www.encryptionconsulting.com/public-key-cryptography-standards/">PKCS</a>)</h2>
<p><em>PKCS</em> is a set of standrats for PKI from 1 to 15. The PKCS standarts listed below are the most common and important ones.</p>

<ul>
  <li>PKCS #1: RSA Cryptograpgy Standart</li>
  <li>PKCS #3: Diffie-Hellman Key Agreement Standard</li>
  <li>PKCS #7/CMS: Cryptographic Message Syntax Standard</li>
  <li>PKCS #9: Selected Object Classes and Attribute Types</li>
  <li>PKCS #10: Certification Request Syntax Standard</li>
  <li>PKCS #12: Personal Information Exchange Syntax Standard</li>
</ul>

<h2 id="certificate-revocation-list-clr">Certificate Revocation List (<a href="https://en.wikipedia.org/wiki/Certificate_revocation_list">CLR</a>)</h2>
<p>These lists are published by some authorities’ servers to indicate which certificates have been revoked.
If you were to lose your credit card for whatever reason, you would like to revocate your credit card.
It works the same for the certificates too. You might lose your private key for whatever reason, or it can get stolen. In this case, 
you would like to revocate your X.509 certificate.</p>

<h2 id="online-certificate-status-protocol-oscp">Online Certificate Status Protocol (<a href="https://en.wikipedia.org/wiki/Online_Certificate_Status_Protocol">OSCP</a>)</h2>
<p>An internet protocol used for gathering the revocation status of an X.509 certificate.</p>

<h2 id="certificate-signing-requests-csr">Certificate Signing Requests (CSR)</h2>
<p>In order to get a certificate signed by a Root CA, a <em>Certificate Signing Request</em> should be made to a Root CA.
There are meta-data that needs to be bundled which is specified by PKCS#10</p>

:ET